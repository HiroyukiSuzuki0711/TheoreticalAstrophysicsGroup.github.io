language: ruby

bundler_args: --retry 3

install:
  # Install Jekyll and dependencies. Nokogiri for html-proofer.
  - sudo apt-get update -qq; sudo apt-get install -qq sshpass
  - bundle config build.nokogiri --use-system-libraries
  - bundle install

# branch whitelist
# The source branch and every branch starts with "pages-" for proposed changes
branches:
  only:
  - source
  - /pages-(.*)/

#script: bundle exec rake site:deploy
script: bundle exec ./summat; bundle exec rake site:deploy --quiet

env:
  global:
    secure: "Eoq2S40HHVSd6LEhdZ3IQ6jAhjG9WwWKTi6YVrxJPoMRZLgVK+wTGP47+saJ+GdD4N1B4V2cobVB99+y1RH1oXxGn5gSs2sOvGICitxJZnxjwDaArmPYCJ8FomSrsj37Wx0FfgcxYmF6ZVsz1NRUJz2f1EN5S8n2ZZVf9ekaGvQ="

# Generate your secure token with the travis gem:
#
# 1) get Github token from your Travis CI profile page
#
# 2) gem install travis
#
# 3) travis encrypt 'GIT_NAME="YOUR_USERNAME" ORG_NAME="YOUR_ORGNAME" GIT_EMAIL="YOUR_EMAIL" GH_TOKEN=YOUR_TOKEN'
#
#    However, this will result in error: data too large - consider using travis encrypt-file or travis env set
#
#    So, to also include CCS (charon) login details use:
#
#    travis encrypt 'CCS_NAME="YOUR_USERNAME" CCS_PW="YOUR_ORGNAME" GH_TOKEN=YOUR_TOKEN'
